!function(e){function o(e,o){o.otherwise("/login"),e.state("home",{url:"/home",templateUrl:"templates/home.html",controller:"homeController"}).state("home.teacher",{url:"/teacher",templateUrl:"templates/teacher.html",controller:"teacherController"}).state("home.student",{url:"/student",templateUrl:"templates/student.html",controller:"studentController"}).state("login",{url:"/login",templateUrl:"templates/login.html",controller:"loginController"})}e.config(["$stateProvider","$urlRouterProvider",o])}(angular.module("myApp",["ui.router","ngStorage"])),function(e){function o(e){function o(o){return e({method:"POST",url:"/api/login",data:o})}function t(o){return e({method:"POST",url:"/api/users",data:o})}function n(o){return console.log(o),e({method:"POST",url:"/api/attendance",data:o.body})}return{userLogin:o,createAccount:t,getAttendance:n}}e.factory("dataService",["$http",o])}(angular.module("myApp")),function(e){function o(e,o,t,n){e.user=n.user,console.log("home controller");var r=e.user.userType;"S"===r&&t.go("home.student"),"T"===r&&t.go("home.teacher"),e.logout=function(){delete n.user,t.go("login")}}e.controller("homeController",["$scope","$http","$state","$sessionStorage",o])}(angular.module("myApp")),function(e){function o(e,o,t,n,r,t){console.log("login controller"),e.toggle=function(){console.log("hello"),$("form").animate({height:"toggle",opacity:"toggle"},"slow")},e.login=function(e){console.log("logging in"),r.userLogin(e).then(function(e){toastr.success("Logged in"),n.user=e.data,console.log(e.data);e.data.type;t.go("home")}).catch(function(e){toastr.error("Please enter valid credentials"),console.log(e)})},e.createAccount=function(e){console.log(e),e.rollNo=Number(e.rollNo),r.createAccount(e).then(function(e){toastr.success("Account created"),n.user=e.data;e.data.type;t.go("home")}).catch(function(e){toastr.error("Please enter valid credentials"),console.log(e)})}}e.controller("loginController",["$scope","$http","$state","$sessionStorage","dataService","$state",o])}(angular.module("myApp"))(function(e){function o(e,o,t,n){function r(o){e.count=0;var t=setInterval(function(){e.$apply(function(){e.count<o?e.count=e.count+1:(clearInterval(t),a.close())})},1e3)}e.user=n.user;var l=e.user;console.log(e.user);var c,a=io();a.on("connect",function(){console.log("connected to server"),e.attendance=function(e){e.subject=e.subject,e._id=l._id,e.code=c,e.class=l.class,e.branch=l.userBranch,console.log(e),a.emit("startEntry",e,function(e){if(e)return console.log("Error");console.log("No error")})},a.on("startAttendance",function(o){console.log("Start attendance"),console.log("Starting timer"),console.log("Code is: "+o.code),c=o.code;var t=o.timerLimit;console.log(o),e.$apply(function(){r(t),e.code=c})}),a.on("invalidEntry",function(e){toastr.error("Invalid entry. Try again")})})}e.controller("studentController",["$scope","$http","$state","$sessionStorage",o])}(angular.module("myApp"))),function(e){function o(e,o,t,n,r){e.students=[],e.showInstantTable=!0,e.user=n.user;var l=e.user;console.log(e.user),e.getAttendance=function(){r.getAttendance({body:{teacherId:l._id,Tclass:l.class,Tbranch:l.Ubranch,Tsubject:l.subject}}).then(function(o){console.log(o.data),e.attendances=o.data,e.showInstantTable=!1})};var c=io();c.on("connect",function(){console.log("connected to server"),e.attendance=function(o){console.log(o),c.emit("startAttendance",{teacherId:e.user._id,branch:l.Ubranch,subject:o.subject,class:o.class},function(e){console.log(e)})},c.on("entryDone",function(o,t){if(t)return console.log("Error");e.$apply(function(){e.students.push(o.user),console.log(e.students)})})})}e.controller("teacherController",["$scope","$http","$state","$sessionStorage","dataService",o])}(angular.module("myApp"));